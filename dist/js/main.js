const rootStyle=document.documentElement.style;let prevX=0,prevY=0,centerWidth=document.body.clientWidth/2,centerHeight=document.body.clientHeight/2;document.addEventListener("mousemove",(function(e){(prevX-e.clientX<5||prevX-e.clientX>5)&&(prevX=e.clientX,rootStyle.setProperty("--tx",(centerWidth-e.clientX)/10+"px")),(prevY-e.clientY<5||prevY-e.clientY>5)&&(prevY=e.clientY,rootStyle.setProperty("--ty",(centerHeight-e.clientY)/10+"px"))}));const rstbtEle=document.querySelector(".restart-button"),elStyle=rstbtEle.style;rstbtEle.onmousemove=function(e){const t=rstbtEle.getBoundingClientRect(),s=e.clientX-t.left,n=e.clientY-t.top,r=s-t.width/2,c=n-t.height/2;elStyle.setProperty("--bt_rx",c/-5+"deg"),elStyle.setProperty("--bt_ry",r/10+"deg")},rstbtEle.onmouseleave=function(e){elStyle.setProperty("--bt_ty","0"),elStyle.setProperty("--bt_rx","0"),elStyle.setProperty("--bt_ry","0")},rstbtEle.onmousedown=function(e){elStyle.setProperty("--bt_tz","-5rem")},rstbtEle.onmouseup=function(e){elStyle.setProperty("--bt_tz","-12px")};const X_CLASS="x",O_CLASS="o",ROWS=[[0,1,2],[3,4,5],[6,7,8]],COLUMNS=[[0,3,6],[1,4,7],[2,5,8]],DIAGNOLS=[[0,4,8],[2,4,6]],tictactoe=document.getElementById("tictactoe"),cellElements=tictactoe.querySelectorAll("[data-cell]"),mainPage=tictactoe.querySelector(".main-page"),board=mainPage.querySelector(".board"),endGameInterface=tictactoe.querySelector(".end-game-interface"),endGameMessage=endGameInterface.querySelector(".end-game-message"),restartButton=tictactoe.querySelector(".restart-button");restartButton.addEventListener("click",handleRestart),cellElements.forEach((e=>{e.addEventListener("mouseover",handleMouseOver),e.addEventListener("mouseout",handleMouseOut)}));let circleTurn=!0;function startGame(){let e=0;cellElements.forEach((t=>{(t.classList.contains("x")||t.classList.contains("o"))&&(setTimeout((()=>{removeMark(t)}),e),e+=100),t.addEventListener("click",handleClick,{once:!0})})),setBoardHoverClass(setCircleTurn=circleTurn)}function handleClick(e){const t=e.target,s=circleTurn?"o":"x";placeMark(t,s),checkWinning(s)?endGame(isDraw=!1):checkDraw()?endGame(isDraw=!0):switchTurns()}function handleMouseOver(e){const t=e.target;if(t.classList.contains("x")||t.classList.contains("o"))return;const s=circleTurn?"o":"x";t.innerHTML="x"==s?'<embed class="mark-img-hover" src="./img/x.svg" type="image/svg+xml" />':'<embed class="mark-img-hover" src="./img/o.svg" type="image/svg+xml" />'}function handleMouseOut(e){const t=e.target;t.classList.contains("x")||t.classList.contains("o")||(t.innerHTML="")}function handleRestart(e){endGameInterface.classList.remove("show"),endGameInterface.classList.add("out"),endGameInterface.addEventListener("animationend",(()=>{endGameInterface.classList.remove("out"),endGameInterface.classList.add("hidden"),startGame()}),{once:!0}),circleTurn=!circleTurn,mainPage.classList.remove("blur"),mainPage.classList.add("focus")}function placeMark(e,t){e.classList.add(t),e.innerHTML="x"==t?'<embed class="mark-img" src="./img/x.svg" type="image/svg+xml" />':'<embed class="mark-img" src="./img/o.svg" type="image/svg+xml" />',e.addEventListener("animationend",(()=>{e.classList.remove("in")}),{once:!0}),e.classList.add("in")}function removeMark(e){e.classList.remove("x"),e.classList.remove("o"),e.classList.remove("glow"),e.addEventListener("animationend",(()=>{e.classList.remove("out"),e.innerHTML=""}),{once:!0}),e.classList.add("out")}function switchTurns(){circleTurn=!circleTurn,setBoardHoverClass(circleTurn)}function setBoardHoverClass(e){board.classList.remove(e?"x":"o"),board.classList.add(e?"o":"x")}function checkWinning(e){return[...ROWS,...COLUMNS,...DIAGNOLS].some((t=>!!t.every((t=>cellElements[t].classList.contains(e)))&&(t.forEach((e=>{cellElements[e].classList.add("glow")})),!0)))}function checkDraw(){return[...cellElements].every((e=>e.classList.contains("x")||e.classList.contains("o")))}function endGame(e){e?endGameMessage.innerText="Draw!":endGameMessage.innerHTML=(circleTurn?'<embed class="mark-img" src="./img/o.svg" type="image/svg+xml" />':'<embed class="mark-img" src="./img/x.svg" type="image/svg+xml" />')+" Wins!",setTimeout((()=>{endGameInterface.classList.remove("hidden"),endGameInterface.classList.add("show"),mainPage.classList.remove("focus"),mainPage.classList.add("blur")}),700)}startGame();